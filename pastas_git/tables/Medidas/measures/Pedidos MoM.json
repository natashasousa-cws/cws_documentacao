{
  "name": "Pedidos MoM",
  "expression": [
    "",
    "VAR UltimaData = ",
    "CALCULATE(",
    "    MAX(fVendas[datekey]),",
    "    REMOVEFILTERS(dCalendario)",
    ")",
    "",
    "VAR UltimaDataReal =",
    "DATE(",
    "    INT(UltimaData / 10000),                            -- Ano",
    "    INT(MOD(UltimaData, 10000) / 100),                  -- MÃªs",
    "    MOD(UltimaData, 100)                                -- Dia",
    ")",
    "",
    "VAR DataLimite =",
    "EDATE(UltimaDataReal, -1)",
    "",
    "VAR MoM =",
    "CALCULATE(",
    "    [Pedidos],",
    "    DATEADD(dCalendario[Data], -1,MONTH),",
    "    FILTER(",
    "        ALL(dCalendario), dCalendario[Data] <= DataLimite",
    "    )",
    ")",
    "",
    "RETURN",
    "MoM"
  ],
  "formatString": "#,0",
  "displayFolder": "Inteligencia_temporal",
  "lineageTag": "3ed36e5f-47e7-46ce-8d9e-1e8d456365d0"
}