{
  "name": "Quantidade de clientes com pedidos MoM",
  "expression": [
    "",
    "VAR UltimaData = ",
    "CALCULATE(",
    "    MAX(fVendas[datekey]),",
    "    REMOVEFILTERS(dCalendario)",
    ")",
    "",
    "VAR UltimaDataReal =",
    "DATE(",
    "    INT(UltimaData / 10000),                            -- Ano",
    "    INT(MOD(UltimaData, 10000) / 100),                  -- MÃªs",
    "    MOD(UltimaData, 100)                                -- Dia",
    ")",
    "",
    "VAR DataLimite =",
    "EDATE(UltimaDataReal, -1)",
    "",
    "VAR MoM =",
    "CALCULATE(",
    "    [Quantidade de clientes com pedidos],",
    "    DATEADD(dCalendario[Data], -1,MONTH),",
    "    FILTER(",
    "        ALL(dCalendario), dCalendario[Data] <= DataLimite",
    "    )",
    ")",
    "",
    "RETURN",
    "MoM"
  ],
  "formatString": "#,0",
  "displayFolder": "Inteligencia_temporal",
  "lineageTag": "ed1b2e18-4e5b-4818-82fa-b78c8654175c"
}