{
  "name": "Top 5 SKUs em quantidade no ultimo carrinho",
  "expression": [
    "",
    "VAR DataUltimoRegistro =",
    "    CALCULATE(",
    "        MAX('dCalendario'[Data]),",
    "        KEEPFILTERS(fCarrinhos_abandonados)",
    "    )",
    "",
    "VAR TabelaUltimoCarrinho =",
    "    CALCULATETABLE(",
    "        fCarrinhos_abandonados,",
    "        'dCalendario'[Data] = DataUltimoRegistro",
    "    )",
    "",
    "VAR Top5SKUs =",
    "    TOPN(",
    "        5,",
    "        SUMMARIZE(",
    "            TabelaUltimoCarrinho,",
    "            fCarrinhos_abandonados[sku_name],",
    "            \"QtdTotal\", SUM(fCarrinhos_abandonados[quantity])",
    "        ),",
    "        [QtdTotal],",
    "        DESC",
    "    )",
    "",
    "RETURN",
    "    CONCATENATEX(",
    "        Top5SKUs,",
    "        UNICHAR(8226) & \" \"",
    "            & fCarrinhos_abandonados[sku_name]",
    "            & \" - \"",
    "            & [QtdTotal]",
    "            & \" un\",",
    "        UNICHAR(10) & UNICHAR(10),   -- quebra de linha",
    "        [QtdTotal],",
    "        DESC",
    "    )",
    ""
  ],
  "lineageTag": "2c218de4-e49f-4fb1-aff8-e7e578ea0904"
}